<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>admin panel</title>
    <link rel="stylesheet" href="/static/main.css">
</head>
<body>
<div class="container">
    <div class="header">
        <h1>Admin Panel</h1>
    </div>
    
    {{if .Error}}
    <div class="error">{{.Error}}</div>
    {{end}}

    {{if .Message}}
    <div class="success">{{.Message}}</div>
    {{end}}

    <!-- Users List -->
    <div class="users-list">
        <div style="display: flex; justify-content: space-between; align-items: center;">
            <h2>Users</h2>
            <button class="btn" style="width: auto; margin: 0;" onclick="openAddUserModal()">Add User</button>
        </div>

        {{if .Users}}
        <table class="users-table">
            <thead>
                <tr>
                    <th>Username</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                {{range .Users}}
                <tr>
                    <td>{{.Name}}</td>
                    <td>
                        <button class="btn-remove" onclick="removeUser('{{.Name}}')">Remove</button>
                    </td>
                </tr>
                {{end}}
            </tbody>
        </table>
        {{else}}
        <p>No users found.</p>
        {{end}}
    </div>

    <!-- Namespaces List -->
    <div class="namespaces-list" style="margin-top: 2rem;">
        <div style="display: flex; justify-content: space-between; align-items: center;">
            <h2>Namespaces</h2>
            <button class="btn" style="width: auto; margin: 0;" onclick="openAddNamespaceModal()">Add Namespace</button>
        </div>
        {{if .Namespaces}}
        <table class="namespaces-table" style="width: 100%; border-collapse: collapse;">
            <thead>
                <tr>
                    <th style="text-align: left; padding: 8px;">Name</th>
                    <th style="text-align: left; padding: 8px;">Actions</th>
                </tr>
            </thead>
            <tbody>
                {{range .Namespaces}}
                <tr>
                    <td style="padding: 8px; border-bottom: 1px solid #ddd;">{{.Name}}</td>
                    <td style="padding: 8px; border-bottom: 1px solid #ddd;">
                        <button class="btn-remove" onclick="removeNamespace('{{.Name}}')">Remove</button>
                    </td>
                </tr>
                {{end}}
            </tbody>
        </table>
        {{else}}
        <p>No namespaces found.</p>
        {{end}}
    </div>
</div>

<div id="addUserModal" class="modal">
    <div class="modal-content">
        <span class="close" onclick="closeAddUserModal()">&times;</span>
        <h2>Add New User</h2>
        <form method="POST" action="/admin/add">
            <div class="form-group">
                <input type="text" id="username" name="username" required placeholder="Username">
            </div>
            <div class="form-group">
                <select id="namespace" name="namespace" style="width: 100%; padding: 8px; margin-bottom: 10px; border: 1px solid #ddd; border-radius: 4px;">
                    <option value="">Select Namespace (Optional)</option>
                    {{range .Namespaces}}
                    <option value="{{.Name}}">{{.Name}}</option>
                    {{end}}
                </select>
            </div>
            <div class="form-group checkbox-group">
                <input type="checkbox" id="isAdmin" name="isAdmin" value="true">
                <label for="isAdmin">Admin Rights</label>
            </div>
            <button type="submit" class="btn">Submit</button>
        </form>
    </div>
</div>

<div id="addNamespaceModal" class="modal">
    <div class="modal-content">
        <span class="close" onclick="closeAddNamespaceModal()">&times;</span>
        <h2>Add New Namespace</h2>
        <form method="POST" action="/admin/add_namespace">
            <div class="form-group">
                <input type="text" id="name" name="name" required placeholder="Namespace Name">
            </div>
            <button type="submit" class="btn">Submit</button>
        </form>
    </div>
</div>

<script>
function openAddUserModal() {
    document.getElementById("addUserModal").style.display = "block";
}

function closeAddUserModal() {
    document.getElementById("addUserModal").style.display = "none";
}

function openAddNamespaceModal() {
    document.getElementById("addNamespaceModal").style.display = "block";
}

function closeAddNamespaceModal() {
    document.getElementById("addNamespaceModal").style.display = "none";
}

window.onclick = function(event) {
    const userModal = document.getElementById("addUserModal");
    const namespaceModal = document.getElementById("addNamespaceModal");
    if (event.target === userModal) {
        userModal.style.display = "none";
    }
    if (event.target === namespaceModal) {
        namespaceModal.style.display = "none";
    }
}

function removeUser(username) {
    if (confirm('Are you sure you want to remove user "' + username + '"?')) {
        const form = document.createElement('form');
        form.method = 'POST';
        form.action = '/admin/remove';
        
        const usernameInput = document.createElement('input');
        usernameInput.type = 'hidden';
        usernameInput.name = 'username';
        usernameInput.value = username;
        
        form.appendChild(usernameInput);
        document.body.appendChild(form);
        form.submit();
    }
}

function removeNamespace(name) {
    if (confirm('Are you sure you want to remove namespace "' + name + '"?')) {
        const form = document.createElement('form');
        form.method = 'POST';
        form.action = '/admin/remove_namespace';
        
        const nameInput = document.createElement('input');
        nameInput.type = 'hidden';
        nameInput.name = 'name';
        nameInput.value = name;
        
        form.appendChild(nameInput);
        document.body.appendChild(form);
        form.submit();
    }
}
</script>

</body>
</html>
